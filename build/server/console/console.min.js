var ebi={message:{type:{none:99,log:0,exception:1,script:2,result:3,requestHTML:4,sendHTML:5},origin:{unkown:99,client:0,server:1,console:2},last:0},createMessageObject:function(){return{id:this.message.last++,type:this.message.type.none,msg:"",origin:this.message.type.unkown,time:this.createTimeString(new Date)}},createTimeString:function(a){var b=a.getHours(),c=a.getMinutes(),d=a.getSeconds(),a=a.getMilliseconds();b<10&&(b="0"+b);c<10&&(c="0"+c);d<10&&(d="0"+d);a<10&&(a="0"+a);a<100&&(a="0"+a);
return b+":"+c+":"+d+"."+a}},ebiconsole={event:{},socket:null,message:{last:0},last:0,htmlModelObj:null};
ebiconsole.connect=function(a){this.socket=new io.Socket(a.host||"localhost",{port:a.port||8080,rememberTransport:!1});this.socket.connect();this.socket.on("connect",function(){});this.socket.on("message",function(a){ebiconsole.event.message(a)});this.socket.on("disconnect",function(){});$("runscript").addEventListener("click",function(){ebiconsole.runScript()});$("clearlogs").addEventListener("click",function(){ebiconsole.clearLog()});$("script").addEventListener("keyup",function(a){a.keyCode===
13&&$("checkReturnScript").checked&&ebiconsole.runScript()});this.socket.send(this.message.createRequestHTML());a=document.querySelector("article#html > section > details > summary").parentNode;document.querySelector("article#html > section > details > summary").addEventListener("click",function(a){return function(){a.getAttribute("open")===null?(a.setAttribute("open","open"),a.getAttribute("loaded")===null&&(ebiconsole.openHTMLTag(a,"0"),a.setAttribute("loaded","loaded"))):a.removeAttribute("open")}}(a),
!1)};
ebiconsole.openHTMLTag=function(a,b){for(var c,d,e=this.selectNode(b).children,f=0,k=e.length,h,g,i,j;f<k;f++)if(j=b+","+f,e[f]!==null&&e[f]!==void 0){c=document.createElement("details");d=document.createElement("summary");if(e[f].tag!=="TextNode"){h="&lt;"+e[f].tag;g=0;for(i=e[f].attributes.length;g<i;g++)h+=' <span class="name">'+e[f].attributes[g].name+'</span>=<span class="value">"'+e[f].attributes[g].value+'"</span>';h+=">";d.innerHTML=h;c.setAttribute("tag","tag");e[f].children.length>0?d.addEventListener("click",
function(a,b){return function(){var c=a.childNodes[0];a.innerHTML="";a.appendChild(c);a.getAttribute("open")===null?(a.setAttribute("open","open"),a.getAttribute("loaded")===null&&ebiconsole.openHTMLTag(a,b)):a.removeAttribute("open")}}(c,j)):c.setAttribute("last","last")}else d.appendChild(document.createTextNode(e[f].value));c.appendChild(d);a.appendChild(c)}};ebiconsole.updateHTMLTag=function(){};
ebiconsole.selectNode=function(a){var a=a.split(","),b=1,c=a.length,d=this.htmlModelObj,e;if(c==1)return this.htmlModelObj;for(;b<c;b++)if(e=a[b],d.children.length>e)d=d.children[e];else return null;return d};ebiconsole.runScript=function(){var a=this.message.createScript($("script").value.replace(/^(.*?)\n*$/,"$1"));this.socket.send(a);this.insertScript(a);if($("checkClearScript").checked)$("script").value=""};
ebiconsole.event.message=function(a){a.mt=ebiconsole.message.createTimeString(new Date);ebiconsole.message.last=+a.last;a.type==ebi.message.type.log?ebiconsole.insertLog(a):a.type==ebi.message.type.result?ebiconsole.insertResult(a):a.type==ebi.message.type.exception?ebiconsole.insertException(a):a.type==ebi.message.type.exception&&ebiconsole.updateHTML(a)};ebiconsole.event.clickHTMLDetails=function(){};ebiconsole.message.createLog=function(a){var b=this.createBase();b.type="LOG";b.msg=a;return b};
ebiconsole.message.createScript=function(a){var b=this.createBase();b.type="SCR";b.msg=a;return b};ebiconsole.message.createRequestHTML=function(){var a=this.createBase();a.type="RHT";return a};ebiconsole.message.createBase=function(){return{id:this.last++,type:null,org:"c",msg:"base message",mt:this.createTimeString(new Date),st:null,ct:null}};
ebiconsole.message.createTimeString=function(a){var b=a.getHours(),c=a.getMinutes(),d=a.getSeconds(),a=a.getMilliseconds();b<10&&(b="0"+b);c<10&&(c="0"+c);d<10&&(d="0"+d);a<10&&(a="0"+a);a<100&&(a="0"+a);return b+":"+c+":"+d+"."+a};ebiconsole.insertLog=function(a){var b=$("message");b.innerHTML+=this.createLogTimesString(a)+" "+a.msg+"\n";b.scrollTop=1E9};ebiconsole.insertScript=function(a){var b=$("message");b.innerHTML+="<span class='script'>>> "+a.msg+"</span>\n";b.scrollTop=1E9};
ebiconsole.insertResult=function(a){var b=$("message");b.innerHTML+="<span class='result'>>> "+a.msg+"</span>\n";b.scrollTop=1E9};ebiconsole.insertException=function(a){var b=$("message");b.innerHTML+="<span class='exception'>>> "+a.msg+"<span>\n";b.scrollTop=1E9};ebiconsole.createLogTimesString=function(a){var b=["ct"],c=0,d,e=[];for(d=b.length;c<d;c++)e.push(a[b[c]]);return"["+e.join("|")+"]"};ebiconsole.clearLog=function(){$("script").innerHTML=""};
ebiconsole.updateHTML=function(a){this.htmlModelObj=a.msg};var $=function(a){return document.getElementById(a)};(function(){ebiconsole.connect({host:"localhost",port:8080})})();
